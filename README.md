### Описание проекта

В данном проекте разрабатывается сервис, который использует обученную модель для предсказания заболевания человека.

### Подготовка к запуску проекта

1. Клонируйте проект с github:

**git clone https://github.com/Julia227/iis**

2. Создайте виртуальное окружение

**python3 -m venv .venv_IIS_proj**

**source .venv_IIS_proj/bin/activate**

3. Установите необходимые библиотеки в виртуальное окружение

**pip install -r requirements.txt**

### Запуск MLFlow
Скрипт для запуска MLFlow находится в папке mlflow в файле start_mlflow.

Для локального развертывания MLFlow достаточно перейтив папку со скриптом и выполнить команду:

sh start_mlflow.sh
Проверить, что фреймворк успешно запустился, можно пройдя в браузере на http://localhost:5000/.

### Исследование данных

В результате исследования:

* Изменен тип данных с числового на категориальный для 9 столбцов (sex, cp, fbs, restecg, exang, slope, ca, thal, target)
* Изменен тип данных с int64 на int8/int16 для 4 столбцов (age, trestbps, chol, thalach)
* Изменен тип данных с float164 float16 для 1 столбца (oldpeak)
* Удален признак 'chol' из-за отсутствия информативности

По построенным графикам были сделаны следующие выводы:

1. По графику распределения целевой переменной - наличия заболевания делаю вывод, что количествово наблюдений в каждой группе не сильно отличается, то есть разница не повлияет на качество обучения модели в будущем анализе (см. график: ./eda/graph1.png)
2. По графику распределения пола в зависимости от наличия заболевания делаю вывод, что заболевания у мужчин встречаются чаще женщин (см. график: ./eda/graph2.png)
3. На матрице корреляции признаков отображена обратная зависимость между возрастом и максимальным количеством сердченых сокращений, примерно такая же наблюдается между частотой сердечных сокращний и ST-маркером, корреляция остальных признаком слабая (см. график: ./eda/graph3.png)
4. По графику зависимости уровня холестерина от возраста делаю вывод, что уровень холестерина достаточно неинформативный признак для определения целевой переменной и линейная зависимость не наблюдается (см. график: ./eda/graph4.png)
5. На графике зависимости максимального сердичного ритма от возраста прослеживается обратная зависимость между ними, при этом наблюдения с более высоким сердечным ритмом чаще подвержены заболеваниям (см. график: ./eda/graph5.png)
6. По графику типа боли в груди в зависимости от наличия заболеваемости делаю вывод, что типы болей 2, 3 и 4 намного чаще подвержены заболеваниям, чем тип боли 1 (см. график: ./eda/graph6.png)
7. Группа людей возрастом от 34 до 55 лет наиболее подвержена заболеваниям (см. график: ./eda/graph7.png)


**Исходный датасет: 11.3 KB**
**Финальный датасет: 7.9 KB**

### Исследование (ЛР2)
В ходе исследования было построено несколько моделей. Все модели показали достаточно хорошие результаты, лучшие результаты были получены после предобработка столбцов с помощью PolynomialFeaturesи оптимальными параметрами, полученными с помощью библиотеки optuna.

#### Метрики полученные при обучении модели следующие:

recall: 0.9069767441860465,
precision: 0.9069767441860465,
f1: 0.9069767441860465,
roc_auc: 0.8928823114869625

#### Данные метрики получены при следующих параметрах модели:

n_estimators: 115,
max_depth: 115,
max_features: 0.35393600475059334
#### RunID финальной модели: 631930cba3004003a5b966dc1e642aec